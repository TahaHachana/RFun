(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;$.Define($$,{Website:{Search:{Client:{bindClick:function(){return a("#search-btn-2").click(function(){var u,v,N;u=c.Delay((v=function(){var x,y,z,B,C;a("#results").empty();a("#pagination").empty();a("#progress").show();x=(y=a("#query-2").val(),(z=function(A){return $$.String(A);},z(y)));B=f.search(x,1);C=$.Tupled(function(D){var E,F,G,H,I,J,L,M;E=D[0];F=D[1];if(E===0){a("#progress").hide();G=h.Div(i.ofArray([h.Attr().Class("alert alert-danger"),h.Text("Your search did not match any functions."),(H=h.Attr(),H.NewAttr("style","width: 30%;"))]));I=a("#results").append(G.Body);J=function(K){K;};J(I);return c.Return(null);}else{if(E===1){L=F[0];M=L[0];j.location.assign("/function/"+M);return c.Return(null);}else{a("#progress").hide();f.displayResults(F);f.paginationDiv(E,1,x);a(".page").first().addClass("active");return c.Return(null);}}});return c.Bind(B,C);},v));N={$:0};return c.Start(u);});},displayResults:function(O){var P,Q,R,_2;P=(Q=(R=$.Tupled(function(S){var T,U,V,W,X,Y,Z;T=S[0];U=S[1];V=S[2];W=S[3];return k.add(h.LI(i.ofArray([h.Attr().Class("list-group-item")])),i.ofArray([k.add(h.H3(i.ofArray([h.Attr().Class("list-group-item-heading")])),i.ofArray([k.add(h.A(i.ofArray([(X="/function/"+T,h.HRef(X)),(Y=h.Attr(),Y.NewAttr("target","_blank"))])),i.ofArray([h.Text(U)]))])),h.Div(i.ofArray([h.Text(V)])),h.H4(i.ofArray([(Z="Package: "+W,h.Text(Z))]))]));}),function(_0){return _0.map(function(_1){return R(_1);});}),Q(O));_2=k.add(h.UL(i.ofArray([h.Attr().Class("col-lg-8")])),P);a("#results").empty().append(_2.Body);return j.scrollTo(0,0);},handleClick:function(_3){var _4,_5,bi;_4=c.Delay((_5=function(){var _7,_8;a("#progress").show();a("#results").empty();a("#pagination").empty();_7=f.search(_3,1);_8=$.Tupled(function(_9){var _,ba,bb,bc,bd,bf,bg,bh;_=_9[0];ba=_9[1];if(_===0){a("#progress").hide();bb=h.Div(i.ofArray([h.Attr().Class("alert alert-danger col-lg-offset-3 col-lg-6"),h.Text("Your search did not match any functions.")]));bc=a("#results").append(bb.Body);bd=function(be){be;};bd(bc);return c.Return(null);}else{if(_===1){bf=ba[0];bg=bf[0];j.location.assign("/function/"+bg);return c.Return(null);}else{a("#progress").hide();bh=f.searchForm();a(".jumbotron").replaceWith(bh.Body);a("#query-2").val(_3);f.displayResults(ba);f.paginationDiv(_,1,_3);a(".page").first().addClass("active");f.bindClick();return c.Return(null);}}});return c.Bind(_7,_8);},_5));bi={$:0};return c.Start(_4);},link:function(bi,bj){return k.add(h.A(i.ofArray([h.HRef(bi)])),i.ofArray([h.Text(bj)]));},main:function(){var bk,bl,bm,bn,bo,bp,bq,br,bw,bx,by,bz,bF;bk=(bl=h.Input(i.ofArray([(bm=h.Attr(),bm.NewAttr("id","query-1")),(bn=h.Attr(),bn.NewAttr("type","text")),h.Attr().Class("query form-control input-lg"),(bo=l.Attr(),bo.NewAttr("autofocus","autofocus")),(bp=l.Attr(),bp.NewAttr("placeholder","R Function"))])),(bq=(br=function(){return function(bt){var bu;bu=bt.KeyCode;if(bu===13){a("#query-1").blur();return a("#search-btn-1").click();}else{return null;}};},function(bv){return m.Events().OnKeyUp(br,bv);}),(bq(bl),bl)));return k.add(h.Div(i.ofArray([h.Attr().Class("row")])),i.ofArray([k.add(h.Div(i.ofArray([h.Attr().Class("col-lg-6 col-lg-offset-3")])),i.ofArray([k.add(h.Div(i.ofArray([h.Attr().Class("input-group input-group-lg")])),i.ofArray([bk,k.add(h.Span(i.ofArray([h.Attr().Class("input-group-btn")])),i.ofArray([(bw=h.Button(i.ofArray([h.Id("search-btn-1"),h.Text("Search"),(bx=h.Attr(),bx.NewAttr("type","button")),h.Attr().Class("btn btn-primary btn-lg")])),(by=(bz=function(){return function(){var bC,bD;bC=(bD=bk.get_Value(),n.Trim(bD));return f.handleClick(bC);};},function(bE){return m.Events().OnClick(bz,bE);}),(by(bw),bw)))]))])),h.Script(i.ofArray([(bF=h.Attr(),bF.NewAttr("src","/Scripts/AutoComplete.js"))]))]))]));},pageLi:function(bG,bH){var bI,bJ;bI=$$.String(bG);bJ=k.add(h.LI(i.ofArray([h.Attr().Class("page")])),i.ofArray([f.link("#",bI)]));bJ.Body.addEventListener("click",function(bK){var bL,bM;bK.preventDefault();f["search'"](bH,bG);a(".page").removeClass("active");bL=bJ["HtmlProvider@32"];return(bM=bJ.Body,function(bN){return bL.AddClass(bM,bN);})("active");},false);return bJ;},pagesUl:function(bO,bP){return k.add(h.UL(i.ofArray([h.Attr().Class("pagination")])),o.toList(o.delay(function(){return bP.map(function(bR){return function(bS){return f.pageLi(bS,bO);}(bR);});})));},paginationDiv:function(bT,bU,bV){var bW,bX,bY,bZ,b0,b1,b2,b3,b4;bW=(bX=(bY=(bZ=bT/10,p.ceil(bZ)),bY<<0),o.toArray(q.range(1,bX)));b0=bW.length;b1=(b2=o.truncate(10,bW),o.toArray(b2));b3=b0===1?h.Div($.New(r,{$:0})):k.add(h.Div(i.ofArray([h.Attr().Class("row")])),i.ofArray([f.pagesUl(bV,b1)]));b4=a("#pagination").append(b3.Body);b4;},search:function(b5,b6){var b7;return c.Delay((b7=function(){var b9,b_;b9=(b6-1)*10;b_=s.Async("Sitelet:0",[b5,b9]);return b_;},b7));},"search'":function(b$,ca){var cb,cc,ch;cb=c.Delay((cc=function(){var ce,cf;ce=f.search(b$,ca);cf=$.Tupled(function(cg){f.displayResults(cg[1]);return c.Return(null);});return c.Bind(ce,cf);},cc));ch={$:0};return c.Start(cb);},searchForm:function(){var ci,cj,ck,cl,cq,cr;return k.add(h.Div(i.ofArray([h.Attr().Class("row"),h.Id("search-form")])),i.ofArray([k.add(h.Div(i.ofArray([h.Attr().Class("input-group input-group-lg")])),i.ofArray([k.add(h.Span(i.ofArray([h.Attr().Class("input-group-addon")])),i.ofArray([h.Text("RFun")])),(ci=h.Input(i.ofArray([(cj=h.Attr(),cj.NewAttr("type","text")),h.Attr().Class("form-control query"),h.Id("query-2")])),(ck=(cl=function(){return function(cn){var co;co=cn.KeyCode;if(co===13){a("#query-2").blur();return a("#search-btn-2").click();}else{return null;}};},function(cp){return m.Events().OnKeyUp(cl,cp);}),(ck(ci),ci))),k.add(h.Span(i.ofArray([h.Attr().Class("input-group-btn")])),i.ofArray([k.add(h.Button(i.ofArray([h.Attr().Class("btn btn-primary"),(cq=h.Attr(),cq.NewAttr("type","button")),h.Id("search-btn-2")])),i.ofArray([h.Text("Search")]))]))])),h.Script(i.ofArray([(cr=h.Attr(),cr.NewAttr("src","/Scripts/AutoComplete.js"))]))]));}},Control:$.Class({get_Body:function(){return f.main();}})}}});$.OnInit(function(){a=$.Safe($$.jQuery);b=$.Safe($$.IntelliFactory.WebSharper);c=$.Safe(b.Concurrency);d=$.Safe($$.Website);e=$.Safe(d.Search);f=$.Safe(e.Client);g=$.Safe(b.Html);h=$.Safe(g.Default);i=$.Safe(b.List);j=$.Safe($$.window);k=$.Safe(g.Operators);l=$.Safe(h.HTML5);m=$.Safe(g.EventsPervasives);n=$.Safe(b.Strings);o=$.Safe(b.Seq);p=$.Safe($$.Math);q=$.Safe(b.Operators);r=$.Safe(i.T);return s=$.Safe(b.Remoting);});$.OnLoad(function(){});}());
