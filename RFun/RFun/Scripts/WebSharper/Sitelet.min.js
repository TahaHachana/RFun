(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;$.Define($$,{Website:{Search:{Client:{bindClick:function(){return a("#search-btn-2").click(function(){var u,v,N;u=c.Delay((v=function(){var x,y,z,B,C;a("#results").empty();a("#pagination").empty();a("#progress").show();x=(y=a("#query-2").val(),(z=function(A){return $$.String(A);},z(y)));B=f.search(x,1);C=$.Tupled(function(D){var E,F,G,H,I,J,L,M;E=D[0];F=D[1];if(E===0){a("#progress").hide();G=h.Div(i.ofArray([h.Attr().Class("alert alert-danger"),h.Text("Your search did not match any functions."),(H=h.Attr(),H.NewAttr("style","width: 30%;"))]));I=a("#results").append(G.Body);J=function(K){K;};J(I);return c.Return(null);}else{if(E===1){L=F[0];M=L[0];j.location.assign("/function/"+M);return c.Return(null);}else{a("#progress").hide();f.displayResults(F);f.paginationDiv(E,1,x);a(".page").first().addClass("active");return c.Return(null);}}});return c.Bind(B,C);},v));N={$:0};return c.Start(u);});},displayResults:function(O){var P,Q,R,_2;P=(Q=(R=$.Tupled(function(S){var T,U,V,W,X,Y,Z;T=S[0];U=S[1];V=S[2];W=S[3];return k.add(h.LI(i.ofArray([h.Attr().Class("list-group-item")])),i.ofArray([k.add(h.H3(i.ofArray([h.Attr().Class("list-group-item-heading")])),i.ofArray([k.add(h.A(i.ofArray([(X="/function/"+T,h.HRef(X)),(Y=h.Attr(),Y.NewAttr("target","_blank"))])),i.ofArray([h.Text(U)]))])),h.Div(i.ofArray([h.Text(V)])),h.H4(i.ofArray([(Z="Package: "+W,h.Text(Z))]))]));}),function(_0){return _0.map(function(_1){return R(_1);});}),Q(O));_2=k.add(h.UL(i.ofArray([h.Attr().Class("col-lg-8")])),P);return a("#results").empty().append(_2.Body);},link:function(_3,_4){return k.add(h.A(i.ofArray([h.HRef(_3)])),i.ofArray([h.Text(_4)]));},main:function(){var _5,_6,_7,_8,_9,_,ba,bb,bf,bg,bh,bi,bG;_5=(_6=h.Input(i.ofArray([(_7=h.Attr(),_7.NewAttr("id","query-1")),(_8=h.Attr(),_8.NewAttr("type","text")),h.Attr().Class("query form-control input-lg"),(_9=l.Attr(),_9.NewAttr("autofocus","autofocus")),(_=l.Attr(),_.NewAttr("placeholder","R Function"))])),(ba=(bb=function(){return function(bd){var be;be=bd.KeyCode;if(be===13){a("#query-1").blur();return a("#search-btn-1").click();}else{return null;}};},function(be){return m.Events().OnKeyUp(bb,be);}),(ba(_6),_6)));return k.add(h.Div(i.ofArray([h.Attr().Class("row")])),i.ofArray([k.add(h.Div(i.ofArray([h.Attr().Class("col-lg-6 col-lg-offset-3")])),i.ofArray([k.add(h.Div(i.ofArray([h.Attr().Class("input-group input-group-lg")])),i.ofArray([_5,k.add(h.Span(i.ofArray([h.Attr().Class("input-group-btn")])),i.ofArray([(bf=h.Button(i.ofArray([h.Id("search-btn-1"),h.Text("Search"),(bg=h.Attr(),bg.NewAttr("type","button")),h.Attr().Class("btn btn-primary btn-lg")])),(bh=(bi=function(){return function(){var bl,bm,bn,bo,bC;bl=(bm=_5.get_Value(),n.Trim(bm));bn=(bo=function(){var bq,br;a("#progress").show();a("#results").empty();a("#pagination").empty();bq=f.search(bl,1);br=$.Tupled(function(bs){var bt,bu,bv,bw,bx,bz,bA,bB;bt=bs[0];bu=bs[1];if(bt===0){a("#progress").hide();bv=h.Div(i.ofArray([h.Attr().Class("alert alert-danger col-lg-offset-3 col-lg-6"),h.Text("Your search did not match any functions.")]));bw=a("#results").append(bv.Body);bx=function(by){by;};bx(bw);return c.Return(null);}else{if(bt===1){bz=bu[0];bA=bz[0];j.location.assign("/function/"+bA);return c.Return(null);}else{a("#progress").hide();bB=f.searchForm();a(".jumbotron").replaceWith(bB.Body);a("#query-2").val(bl);f.displayResults(bu);f.paginationDiv(bt,1,bl);a(".page").first().addClass("active");f.bindClick();return c.Return(null);}}});return c.Bind(bq,br);},c.Delay(bo));bC=function(bD){var bE;bE={$:0};return c.Start(bD);};return bC(bn);};},function(bF){return m.Events().OnClick(bi,bF);}),(bh(bf),bf)))]))])),h.Script(i.ofArray([(bG=h.Attr(),bG.NewAttr("src","/Scripts/AutoComplete.js"))]))]))]));},pageLi:function(bH,bI,bJ){var bK,bL;bK=$$.String(bH);bL=k.add(h.LI(i.ofArray([h.Attr().Class("page")])),i.ofArray([f.link("#",bK)]));bL.Body.addEventListener("click",function(bM){var bN,bO;bM.preventDefault();f["search'"](bJ,bH);a(".page").removeClass("active");bN=bL["HtmlProvider@32"];return(bO=bL.Body,function(bP){return bN.AddClass(bO,bP);})("active");},false);return bL;},pagesUl:function(bQ,bR,bS){return k.add(h.UL(i.ofArray([h.Attr().Class("pagination")])),o.toList(o.delay(function(){return bS.map(function(bV){return function(bW){return f.pageLi(bW,bQ,bR);}(bV);});})));},paginationDiv:function(bX,bY,bZ){var b0,b1,b2,b3,b4,b5,b6,b7,b8;b0=(b1=(b2=(b3=bX/10,p.ceil(b3)),b2<<0),o.toArray(q.range(1,b1)));b4=b0.length;b5=(b6=o.truncate(10,b0),o.toArray(b6));b7=b4===1?h.Div($.New(r,{$:0})):k.add(h.Div(i.ofArray([h.Attr().Class("row")])),i.ofArray([f.pagesUl(bY,bZ,b5,b4)]));b8=a("#pagination").append(b7.Body);b8;},search:function(b9,b_){var b$;return c.Delay((b$=function(){var cb,cc;cb=(b_-1)*10;cc=s.Async("Sitelet:0",[b9,cb]);return cc;},b$));},"search'":function(cd,ce){var cf,cg,cl;cf=c.Delay((cg=function(){var ci,cj;ci=f.search(cd,ce);cj=$.Tupled(function(ck){f.displayResults(ck[1]);return c.Return(null);});return c.Bind(ci,cj);},cg));cl={$:0};return c.Start(cf);},searchForm:function(){var cm,cn,co,cp,cu,cv;return k.add(h.Div(i.ofArray([h.Attr().Class("row"),h.Id("search-form")])),i.ofArray([k.add(h.Div(i.ofArray([h.Attr().Class("input-group input-group-lg")])),i.ofArray([k.add(h.Span(i.ofArray([h.Attr().Class("input-group-addon")])),i.ofArray([h.Text("RFun")])),(cm=h.Input(i.ofArray([(cn=h.Attr(),cn.NewAttr("type","text")),h.Attr().Class("form-control query"),h.Id("query-2")])),(co=(cp=function(){return function(cr){var cs;cs=cr.KeyCode;if(cs===13){a("#query-2").blur();return a("#search-btn-2").click();}else{return null;}};},function(ct){return m.Events().OnKeyUp(cp,ct);}),(co(cm),cm))),k.add(h.Span(i.ofArray([h.Attr().Class("input-group-btn")])),i.ofArray([k.add(h.Button(i.ofArray([h.Attr().Class("btn btn-primary"),(cu=h.Attr(),cu.NewAttr("type","button")),h.Id("search-btn-2")])),i.ofArray([h.Text("Search")]))]))])),h.Script(i.ofArray([(cv=h.Attr(),cv.NewAttr("src","/Scripts/AutoComplete.js"))]))]));}},Control:$.Class({get_Body:function(){return f.main();}})}}});$.OnInit(function(){a=$.Safe($$.jQuery);b=$.Safe($$.IntelliFactory.WebSharper);c=$.Safe(b.Concurrency);d=$.Safe($$.Website);e=$.Safe(d.Search);f=$.Safe(e.Client);g=$.Safe(b.Html);h=$.Safe(g.Default);i=$.Safe(b.List);j=$.Safe($$.window);k=$.Safe(g.Operators);l=$.Safe(h.HTML5);m=$.Safe(g.EventsPervasives);n=$.Safe(b.Strings);o=$.Safe(b.Seq);p=$.Safe($$.Math);q=$.Safe(b.Operators);r=$.Safe(i.T);return s=$.Safe(b.Remoting);});$.OnLoad(function(){});}());
